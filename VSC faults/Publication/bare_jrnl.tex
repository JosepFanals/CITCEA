
%% bare_jrnl.tex
%% V1.4b
%% 2015/08/26
%% by Michael Shell
%% see http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.8b or later) with an IEEE
%% journal paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/pkg/ieeetran
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall the IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%*************************************************************************


% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. The IEEE's font choices and paper sizes can   ***
% *** trigger bugs that do not appear when using other class files.       ***                          ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



\documentclass[journal]{IEEEtran}
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[journal]{../sty/IEEEtran}


\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}

\usepackage{pgfplots} % per a graficar amb LaTeX
\pgfplotsset{samples=2000} % número màxim de punts d'una corba que genera ell, canviar
\pgfplotsset{compat=1.16} % perquè si no el pgfplot dóna error
\usepackage{import} % per a les imatges d'Inkscape
\usepackage{xifthen} % per a les imatges d'Inkscape
\usepackage{pdfpages} % per a les imatges d'Inkscape
\usepackage{transparent} % per a les imatges d'Inkscape
\usepackage[RPvoltages]{circuitikz} % per tal que no salti warning
\usetikzlibrary{arrows, decorations.markings, arrows.meta} % per a dibuixar fletxes d'intensitat
\usepackage{balance}
%\usepackage{flushend}
\usepackage{lettrine}


% Some very useful LaTeX packages include:
% (uncomment the ones you want to load)


% *** MISC UTILITY PACKAGES ***
%
%\usepackage{ifpdf}
% Heiko Oberdiek's ifpdf.sty is very useful if you need conditional
% compilation based on whether the output is pdf or dvi.
% usage:
% \ifpdf
%   % pdf code
% \else
%   % dvi code
% \fi
% The latest version of ifpdf.sty can be obtained from:
% http://www.ctan.org/pkg/ifpdf
% Also, note that IEEEtran.cls V1.7 and later provides a builtin
% \ifCLASSINFOpdf conditional that works the same way.
% When switching from latex to pdflatex and vice-versa, the compiler may
% have to be run twice to clear warning/error messages.






% *** CITATION PACKAGES ***
%
%\usepackage{cite}
% cite.sty was written by Donald Arseneau
% V1.6 and later of IEEEtran pre-defines the format of the cite.sty package
% \cite{} output to follow that of the IEEE. Loading the cite package will
% result in citation numbers being automatically sorted and properly
% "compressed/ranged". e.g., [1], [9], [2], [7], [5], [6] without using
% cite.sty will become [1], [2], [5]--[7], [9] using cite.sty. cite.sty's
% \cite will automatically add leading space, if needed. Use cite.sty's
% noadjust option (cite.sty V3.8 and later) if you want to turn this off
% such as if a citation ever needs to be enclosed in parenthesis.
% cite.sty is already installed on most LaTeX systems. Be sure and use
% version 5.0 (2009-03-20) and later if using hyperref.sty.
% The latest version can be obtained at:
% http://www.ctan.org/pkg/cite
% The documentation is contained in the cite.sty file itself.






% *** GRAPHICS RELATED PACKAGES ***
%
\ifCLASSINFOpdf
  % \usepackage[pdftex]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../pdf/}{../jpeg/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.pdf,.jpeg,.png}
\else
  % or other class option (dvipsone, dvipdf, if not using dvips). graphicx
  % will default to the driver specified in the system graphics.cfg if no
  % driver is specified.
  % \usepackage[dvips]{graphicx}
  % declare the path(s) where your graphic files are
  % \graphicspath{{../eps/}}
  % and their extensions so you won't have to specify these with
  % every instance of \includegraphics
  % \DeclareGraphicsExtensions{.eps}
\fi
% graphicx was written by David Carlisle and Sebastian Rahtz. It is
% required if you want graphics, photos, etc. graphicx.sty is already
% installed on most LaTeX systems. The latest version and documentation
% can be obtained at: 
% http://www.ctan.org/pkg/graphicx
% Another good source of documentation is "Using Imported Graphics in
% LaTeX2e" by Keith Reckdahl which can be found at:
% http://www.ctan.org/pkg/epslatex
%
% latex, and pdflatex in dvi mode, support graphics in encapsulated
% postscript (.eps) format. pdflatex in pdf mode supports graphics
% in .pdf, .jpeg, .png and .mps (metapost) formats. Users should ensure
% that all non-photo figures use a vector format (.eps, .pdf, .mps) and
% not a bitmapped formats (.jpeg, .png). The IEEE frowns on bitmapped formats
% which can result in "jaggedy"/blurry rendering of lines and letters as
% well as large increases in file sizes.
%
% You can find documentation about the pdfTeX application at:
% http://www.tug.org/applications/pdftex





% *** MATH PACKAGES ***
%
%\usepackage{amsmath}
% A popular package from the American Mathematical Society that provides
% many useful and powerful commands for dealing with mathematics.
%
% Note that the amsmath package sets \interdisplaylinepenalty to 10000
% thus preventing page breaks from occurring within multiline equations. Use:
%\interdisplaylinepenalty=2500
% after loading amsmath to restore such page breaks as IEEEtran.cls normally
% does. amsmath.sty is already installed on most LaTeX systems. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/amsmath





% *** SPECIALIZED LIST PACKAGES ***
%
%\usepackage{algorithmic}
% algorithmic.sty was written by Peter Williams and Rogerio Brito.
% This package provides an algorithmic environment fo describing algorithms.
% You can use the algorithmic environment in-text or within a figure
% environment to provide for a floating algorithm. Do NOT use the algorithm
% floating environment provided by algorithm.sty (by the same authors) or
% algorithm2e.sty (by Christophe Fiorio) as the IEEE does not use dedicated
% algorithm float types and packages that provide these will not provide
% correct IEEE style captions. The latest version and documentation of
% algorithmic.sty can be obtained at:
% http://www.ctan.org/pkg/algorithms
% Also of interest may be the (relatively newer and more customizable)
% algorithmicx.sty package by Szasz Janos:
% http://www.ctan.org/pkg/algorithmicx




% *** ALIGNMENT PACKAGES ***
%
%\usepackage{array}
% Frank Mittelbach's and David Carlisle's array.sty patches and improves
% the standard LaTeX2e array and tabular environments to provide better
% appearance and additional user controls. As the default LaTeX2e table
% generation code is lacking to the point of almost being broken with
% respect to the quality of the end results, all users are strongly
% advised to use an enhanced (at the very least that provided by array.sty)
% set of table tools. array.sty is already installed on most systems. The
% latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/array


% IEEEtran contains the IEEEeqnarray family of commands that can be used to
% generate multiline equations as well as matrices, tables, etc., of high
% quality.




% *** SUBFIGURE PACKAGES ***
%\ifCLASSOPTIONcompsoc
%  \usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
%\else
%  \usepackage[caption=false,font=footnotesize]{subfig}
%\fi
% subfig.sty, written by Steven Douglas Cochran, is the modern replacement
% for subfigure.sty, the latter of which is no longer maintained and is
% incompatible with some LaTeX packages including fixltx2e. However,
% subfig.sty requires and automatically loads Axel Sommerfeldt's caption.sty
% which will override IEEEtran.cls' handling of captions and this will result
% in non-IEEE style figure/table captions. To prevent this problem, be sure
% and invoke subfig.sty's "caption=false" package option (available since
% subfig.sty version 1.3, 2005/06/28) as this is will preserve IEEEtran.cls
% handling of captions.
% Note that the Computer Society format requires a larger sans serif font
% than the serif footnote size font used in traditional IEEE formatting
% and thus the need to invoke different subfig.sty package options depending
% on whether compsoc mode has been enabled.
%
% The latest version and documentation of subfig.sty can be obtained at:
% http://www.ctan.org/pkg/subfig




% *** FLOAT PACKAGES ***
%
%\usepackage{fixltx2e}
% fixltx2e, the successor to the earlier fix2col.sty, was written by
% Frank Mittelbach and David Carlisle. This package corrects a few problems
% in the LaTeX2e kernel, the most notable of which is that in current
% LaTeX2e releases, the ordering of single and double column floats is not
% guaranteed to be preserved. Thus, an unpatched LaTeX2e can allow a
% single column figure to be placed prior to an earlier double column
% figure.
% Be aware that LaTeX2e kernels dated 2015 and later have fixltx2e.sty's
% corrections already built into the system in which case a warning will
% be issued if an attempt is made to load fixltx2e.sty as it is no longer
% needed.
% The latest version and documentation can be found at:
% http://www.ctan.org/pkg/fixltx2e


%\usepackage{stfloats}
% stfloats.sty was written by Sigitas Tolusis. This package gives LaTeX2e
% the ability to do double column floats at the bottom of the page as well
% as the top. (e.g., "\begin{figure*}[!b]" is not normally possible in
% LaTeX2e). It also provides a command:
%\fnbelowfloat
% to enable the placement of footnotes below bottom floats (the standard
% LaTeX2e kernel puts them above bottom floats). This is an invasive package
% which rewrites many portions of the LaTeX2e float routines. It may not work
% with other packages that modify the LaTeX2e float routines. The latest
% version and documentation can be obtained at:
% http://www.ctan.org/pkg/stfloats
% Do not use the stfloats baselinefloat ability as the IEEE does not allow
% \baselineskip to stretch. Authors submitting work to the IEEE should note
% that the IEEE rarely uses double column equations and that authors should try
% to avoid such use. Do not be tempted to use the cuted.sty or midfloat.sty
% packages (also by Sigitas Tolusis) as the IEEE does not format its papers in
% such ways.
% Do not attempt to use stfloats with fixltx2e as they are incompatible.
% Instead, use Morten Hogholm'a dblfloatfix which combines the features
% of both fixltx2e and stfloats:
%
% \usepackage{dblfloatfix}
% The latest version can be found at:
% http://www.ctan.org/pkg/dblfloatfix




%\ifCLASSOPTIONcaptionsoff
%  \usepackage[nomarkers]{endfloat}
% \let\MYoriglatexcaption\caption
% \renewcommand{\caption}[2][\relax]{\MYoriglatexcaption[#2]{#2}}
%\fi
% endfloat.sty was written by James Darrell McCauley, Jeff Goldberg and 
% Axel Sommerfeldt. This package may be useful when used in conjunction with 
% IEEEtran.cls'  captionsoff option. Some IEEE journals/societies require that
% submissions have lists of figures/tables at the end of the paper and that
% figures/tables without any captions are placed on a page by themselves at
% the end of the document. If needed, the draftcls IEEEtran class option or
% \CLASSINPUTbaselinestretch interface can be used to increase the line
% spacing as well. Be sure and use the nomarkers option of endfloat to
% prevent endfloat from "marking" where the figures would have been placed
% in the text. The two hack lines of code above are a slight modification of
% that suggested by in the endfloat docs (section 8.4.1) to ensure that
% the full captions always appear in the list of figures/tables - even if
% the user used the short optional argument of \caption[]{}.
% IEEE papers do not typically make use of \caption[]'s optional argument,
% so this should not be an issue. A similar trick can be used to disable
% captions of packages such as subfig.sty that lack options to turn off
% the subcaptions:
% For subfig.sty:
% \let\MYorigsubfloat\subfloat
% \renewcommand{\subfloat}[2][\relax]{\MYorigsubfloat[]{#2}}
% However, the above trick will not work if both optional arguments of
% the \subfloat command are used. Furthermore, there needs to be a
% description of each subfigure *somewhere* and endfloat does not add
% subfigure captions to its list of figures. Thus, the best approach is to
% avoid the use of subfigure captions (many IEEE journals avoid them anyway)
% and instead reference/explain all the subfigures within the main caption.
% The latest version of endfloat.sty and its documentation can obtained at:
% http://www.ctan.org/pkg/endfloat
%
% The IEEEtran \ifCLASSOPTIONcaptionsoff conditional can also be used
% later in the document, say, to conditionally put the References on a 
% page by themselves.




% *** PDF, URL AND HYPERLINK PACKAGES ***
%
%\usepackage{url}
% url.sty was written by Donald Arseneau. It provides better support for
% handling and breaking URLs. url.sty is already installed on most LaTeX
% systems. The latest version and documentation can be obtained at:
% http://www.ctan.org/pkg/url
% Basically, \url{my_url_here}.




% *** Do not adjust lengths that control margins, column widths, etc. ***
% *** Do not use packages that alter fonts (such as pslatex).         ***
% There should be no need to do such things with IEEEtran.cls V1.6 and later.
% (Unless specifically asked to do so by the journal or conference you plan
% to submit to, of course. )


% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}

\newcommand{\un}[1]{\underline{#1}} % per tenir underline

\usepackage{subcaption}
\usepackage{pgfplots}
\pgfplotsset{compat=1.17}
\usetikzlibrary{arrows.meta}
\usepackage{tikz}
\usepackage{circuitikz}

\begin{document}
%
% paper title
% Titles are generally capitalized except for words such as a, an, and, as,
% at, but, by, for, in, nor, of, on, or, the, to and up, which are usually
% not capitalized unless they are the first or last word of the title.
% Linebreaks \\ can be used within to get better formatting as desired.
% Do not put math or special symbols in the title.
\title{Positive and negative sequence currents optimization to improve voltages during unbalanced faults}
%
%
% author names and IEEE memberships
% note positions of commas and nonbreaking spaces ( ~ ) LaTeX will not break
% a structure at a ~ so this keeps an author's name from being broken across
% two lines.
% use \thanks{} to gain access to the first footnote area
% a separate \thanks must be used for each paragraph as LaTeX2e's \thanks
% was not built to handle multiple paragraphs
%

% \author{Marc Cheah-Mañé~\IEEEmembership{Member,~IEEE}, Oriol Gomis-Bellmunt~\IEEEmembership{Fellow,~IEEE}, Eduardo Prieto-Araujo~\IEEEmembership{Member,~IEEE}, Jie Song~\IEEEmembership{Member,~IEEE}, Josep Fanals,~\IEEEmembership{Member,~IEEE,}
\author{Fill this


% \thanks{M. Shell was with the Department
% of Electrical and Computer Engineering, Georgia Institute of Technology, Atlanta,
% GA, 30332 USA e-mail: (see http://www.michaelshell.org/contact.html).}% <-this % stops a space
\thanks{Fill this}% <-this % stops a space
}

% note the % following the last \IEEEmembership and also \thanks - 
% these prevent an unwanted space from occurring between the last author name
% and the end of the author line. i.e., if you had this:
% 
% \author{....lastname \thanks{...} \thanks{...} }
%                     ^------------^------------^----Do not want these spaces!
%
% a space would be appended to the last name and could cause every name on that
% line to be shifted left slightly. This is one of those "LaTeX things". For
% instance, "\textbf{A} \textbf{B}" will typeset as "A B" not "AB". To get
% "AB" then you have to do: "\textbf{A}\textbf{B}"
% \thanks is no different in this regard, so shield the last } of each \thanks
% that ends a line with a % and do not let a space in before the next \thanks.
% Spaces after \IEEEmembership other than the last one are OK (and needed) as
% you are supposed to have spaces between the names. For what it is worth,
% this is a minor point as most people would not even notice if the said evil
% space somehow managed to creep in.



% The paper headers
% \markboth{IEEE Transactions on Power Systems, Vol. XX, No. XX, XX 2020}{}%





% If you want to put a publisher's ID mark on the page you can do it like
% this:
%\IEEEpubid{0000--0000/00\$00.00~\copyright~2015 IEEE}
% Remember, if you use this you must call \IEEEpubidadjcol in the second
% column for its text to clear the IEEEpubid mark.



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

% As a general rule, do not put math, special symbols or citations
% in the abstract or keywords.
\begin{abstract}
Grid faults constitute a series of unfortunate events that compromise power systems. With the increasing integration of renewables and their associated power electronics converters, the injected currents are controllable, but at the same time, they have to be limited so as not to damage the semiconductors. This poses the challenge to determine the combination of currents that improves the most the voltages at the point of common coupling. In this paper, such an issue is approached from an optimization perspective. Solving the optimization problem allows comparing its solutions with respect to the ones obtained by following the grid code control laws. Two fundamental scenarios are presented: one with a single converter, and another with two converters. Several parameters are varied for all kinds of faults to spot the changes on the currents, such as the severity of the fault, the distance of a hypothetical submarine cable, and the resistive/inductive ratio of the impedances. Overall the results indicate that injecting only reactive power is not always the preferable choice. While grid codes are not optimal, they can be regarded as near-optimal decision rules.
\end{abstract}

% Note that keywords are not normally used for peer review papers.
\begin{IEEEkeywords}
VSC, Grid-Support, Reference Optimization, Asymmetrical Fault, Current Saturation
\end{IEEEkeywords}






% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle



\section{Introduction}
% The very first letter is a 2 line initial drop letter followed
% by the rest of the first word in caps.
% 
% form to use if the first word consists of a single letter:
% \IEEEPARstart{A}{demo} file is ....
% 
% form to use if you need the single drop letter followed by
% normal text (unknown if ever used by the IEEE):
% \IEEEPARstart{A}{}demo file is ....
% 
% Some journals put the first two words in caps:
% \IEEEPARstart{T}{his demo} file is ....
% 
% Here we have the typical use of a "T" for an initial drop letter
% and "HIS" in caps to complete the first word.
\IEEEPARstart{T}{he} rise in renewable energies has carried along with it the inclusion of Voltage Source Converters (VSC) as a means of coupling energetic resources to the grid while providing controllability \cite{imhof2014power, eren2011control, blaabjerg2015power}. Adopting such power electronics equipment has induced a progressive shrinkage on synchronous generators' influence in power systems. The high flexibility of VSC control enables advanced grid-support control, which could enhance the system performance during the fault and ensure a fast recovery after the fault clearance. However, compared to electrical machines, VSCs cannot withstand overloads \cite{abdou2013improving}. Indeed, current (and also voltage) limitations cause VSC to behave differently. They reach what is called a saturated state. Many equilibrium points may arise as a result of that, especially in grids formed by multiple converters operating in critical conditions. The solution to such systems is also likely to become an arduous task to compute, as saturation states are defined by non-linear equations, or in more detail, by piecewise functions. 

Not only do currents have to be constrained to not exceed the limitations, but they also have to collaborate on improving the voltages \cite{morren2006grid}. This becomes visible when looking at the requirements imposed by Transmission System Operators (TSO) in its grid codes \cite{erlich2006advanced, zhang2015coordinated}. Although this was not the case years ago, when wind power represented a small percentage of the electricity mix, nowadays wind power plants have to control active and reactive power \cite{mohseni2012review}. Besides, they have to transiently support the faults. The latter aspect is often referred to as low voltage ride through (LVRT) \cite{tsili2009review, conroy2007low}. The traditional approach to raise the voltage at the point of common coupling is to inject reactive power proportionally to the severity of the fault \cite{mohseni2012review, haddadi2020negative}. During the analysis of faults, it is often the case that voltages are decomposed into positive, negative, and zero sequence values. By doing so, the study of the fault is expected to be simplified, and in addition to that, some intuition can be build from inspecting the positive and negative sequence voltages. A concerning unbalanced fault is such that substantially decreases the positive sequence voltage with respect to the nominal voltage while the negative sequence voltage increases. Both sequences have to be thoroughly controlled, as discussed in \cite{haddadi2020negative, camacho2017positive}.

Nevertheless, for the most part, grid codes only specify reactive power injection during faults \cite{ree_gc, paspatis2019voltage}. %check this
This is because transmission networks are often considered to have an inductive characteristic. The influence of the grid impedance characteristics of the system optimized under an equilibrium state is covered in \cite{camacho2017positive}, where the authors express the currents to inject as a function of the voltage and the impedances. A recursive relation between the voltage and the current is found, which invalidates the possibility of working with a closed-form expression from where to compute the optimal currents solution. Expressions of the same nature are proposed in \cite{camacho2012flexible}, where instead of attempting to solve the optimization problem, a control parameter is introduced. This takes various values, but no analysis is carried out to determine the optimal choice. The effect of varying this control parameter is studied in \cite{guo2013asymmetrical}, although it is not computed with a systematic approach, but rather, manually. Reference \cite{shabestary2016analytical} proposes a maximum allowed support (MAS) control scheme that is said to provide the maximum voltage support and simultaneously satisfying the current limitations. The study does not explicitly indicate how the current is distributed among the real and the imaginary positive and negative sequence components, and variations in input parameters are rather limited. Another voltage support scheme is presented in \cite{dai2015novel}, where the injected currents depend neither on the active power nor the filter resistance. In addition, positive and negative sequence grid voltage values are imposed, which facilitates the obtention of the steady-state current values. A variation of the grid code requirements is depicted in \cite{shabestary2018asymmetrical}. The authors found it to provide better results than conventional grid codes. The majority of the grid support strategies described above are compared and summarized in \cite{shabestary2018overview}. It is worth mentioning that the systems under study considered in these references include a single VSC. Further conclusions are expected to be extracted from examining a two-converter case study.

This paper proposes a methodology to identify the optimized system equilibrium point during the fault considering converters' current limitations. 
Two other control rules are implemented. One focuses on solving the optimization problem but in addition to the other constraints, it is restricted to only injecting reactive power. The third control rule follows the implementation of grid code specifications with its characteristic droop profile. These three options are tested for both balanced and unbalanced faults, where this last category includes the line to ground, the line to line, and the double line to ground faults. First, a basic system with a single converter is studied. Then, the analysis is repeated for a system with two converters in order to identify their interaction in saturated states.

Two main contributions come from this paper. On the one hand, it indicates the preferable injected currents under diverse conditions. A deeper understanding of the optimality of the solutions is expected to be gained from it. On the other hand, comparisons between the optimal solution and the one obtained by following the grid code are presented. An assessment about the convenience of grid codes to support faults can be derived, which should be useful when proposing future modifications in order to evolve towards more resilient grids.

% The structure of the paper is as follows. Section \ref{problem_f} formulates the optimization problem and details the methodology employed. Section \ref{1conv} presents the results together with the corresponding discussion for a single converter case. Section \ref{2conv} analyzes similar situations for a basic power system with two converters. Finally, Section \ref{concl} concludes this work.  
% and write this paragraph

% You must have at least 2 lines in the paragraph with the drop letter
% (should never be an issue)


% \subsection{Subsection Heading Here}
% Subsection text here.

% needed in second column of first page if using \IEEEpubid
%\IEEEpubidadjcol

% \subsubsection{Subsubsection Heading Here}
% Subsubsection text here.


% An example of a floating figure using the graphicx package.
% Note that \label must occur AFTER (or within) \caption.
% For figures, \caption should occur after the \includegraphics.
% Note that IEEEtran v1.7 and later has special internal code that
% is designed to preserve the operation of \label within \caption
% even when the captionsoff option is in effect. However, because
% of issues like this, it may be the safest practice to put all your
% \label just after \caption rather than within \caption{}.
%
% Reminder: the "draftcls" or "draftclsnofoot", not "draft", class
% option should be used if it is desired that the figures are to be
% displayed while in draft mode.
%
%\begin{figure}[!t]
%\centering
%\includegraphics[width=2.5in]{myfigure}
% where an .eps filename suffix will be assumed under latex, 
% and a .pdf suffix will be assumed for pdflatex; or what has been declared
% via \DeclareGraphicsExtensions.
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure}

% Note that the IEEE typically puts floats only at the top, even when this
% results in a large percentage of a column being occupied by floats.


% An example of a double column floating figure using two subfigures.
% (The subfig.sty package must be loaded for this to work.)
% The subfigure \label commands are set within each subfloat command,
% and the \label for the overall figure must come after \caption.
% \hfil is used as a separator to get equal spacing.
% Watch out that the combined width of all the subfigures on a 
% line do not exceed the text width or a line break will occur.
%
%\begin{figure*}[!t]
%\centering
%\subfloat[Case I]{\includegraphics[width=2.5in]{box}%
%\label{fig_first_case}}
%\hfil
%\subfloat[Case II]{\includegraphics[width=2.5in]{box}%
%\label{fig_second_case}}
%\caption{Simulation results for the network.}
%\label{fig_sim}
%\end{figure*}
%
% Note that often IEEE papers with subfigures do not employ subfigure
% captions (using the optional argument to \subfloat[]), but instead will
% reference/describe all of them (a), (b), etc., within the main caption.
% Be aware that for subfig.sty to generate the (a), (b), etc., subfigure
% labels, the optional argument to \subfloat must be present. If a
% subcaption is not desired, just leave its contents blank,
% e.g., \subfloat[].


% An example of a floating table. Note that, for IEEE style tables, the
% \caption command should come BEFORE the table and, given that table
% captions serve much like titles, are usually capitalized except for words
% such as a, an, and, as, at, but, by, for, in, nor, of, on, or, the, to
% and up, which are usually not capitalized unless they are the first or
% last word of the caption. Table text will default to \footnotesize as
% the IEEE normally uses this smaller font for tables.
% The \label must come after \caption as always.
%
%\begin{table}[!t]
%% increase table row spacing, adjust to taste
%\renewcommand{\arraystretch}{1.3}
% if using array.sty, it might be a good idea to tweak the value of
% \extrarowheight as needed to properly center the text within the cells
%\caption{An Example of a Table}
%\label{table_example}
%\centering
%% Some packages, such as MDW tools, offer better commands for making tables
%% than the plain LaTeX2e tabular which is used here.
%\begin{tabular}{|c||c|}
%\hline
%One & Two\\
%\hline
%Three & Four\\
%\hline
%\end{tabular}
%\end{table}


% Note that the IEEE does not put floats in the very first column
% - or typically anywhere on the first page for that matter. Also,
% in-text middle ("here") positioning is typically not used, but it
% is allowed and encouraged for Computer Society conferences (but
% not Computer Society journals). Most IEEE journals/conferences use
% top floats exclusively. 
% Note that, LaTeX2e, unlike IEEE journals/conferences, places
% footnotes above bottom floats. This can be corrected via the
% \fnbelowfloat command of the stfloats package.



\section{Formulation} \label{problem_f}
\subsection{System modeling}
VSCs are elements that interconnect DC systems with AC systems. As shown in Figure \ref{fig:average_model}, they can be modeled following the so-called average model, where the switchings of the semiconductors are excluded. The VSC has been assumed to be connected to the AC grid with a filter in between denoted by $\un{Z}_z$. The control strategy of the VSC consists of adjusting the voltages appropriately so that currents can indirectly meet the references \cite{andani2018controller}. 

% Power systems are likely to involve more than a single converter. Therefore, the modeling is approached from a generalized perspective. Figure \ref{fig:sys_n} presents the modeling for a system with $n$ converters connected to a grid with $n_g$ buses represented by its admittance matrix $\mathbf{\un{Y}_g}$. In addition, the grid has been modeled with a Norton equivalent instead of a Thevenin equivalent for simplification purposes. The VSCs are treated as current sources that inject currents of the form of $\un{I}_k\forall k\in[1,...,n]$. Additional impedances denoted by $\un{Z}_{vk}$ connect the point of common coupling to the grid. Such point of common coupling is precisely where the voltages ought to be improved. 


\begin{figure}[] \centering \tiny
\begin{circuitikz}[american]
\thicklines

% \draw (-2.75,2) to [isource, l_=$\underline{I}_{t}$] (-4.25,2);
% \draw (-4.25,0.7) to [R, l=$\underline{Z}_{t}$, european] (-2.75,0.7);
% \draw (-2.75,2) to [short] (-2.75,0.7);
% \draw (-4.25,2) to [short] (-4.25,0.7);
% \draw (-4.25,1.35) to [short, -*] (-4.5,1.35);
% \draw (-2.75,1.35) to [short, *-] (-2.5,1.35);
% \draw (-2.5,1.35) to [short] (-2.5,0);
% \draw (-2.75,0) to [short] (-2.25,0);

\draw (0,0) to [C] (0,2);
\draw (1.0,0) to [isource, i=$I_{dc}$] (1.0,2);
\node at (-0.25,1.3) {$C_{dc}$};
\draw (1,2) to [short, -*] (0,2);
\draw (1,0) to [short, -*] (0,0);
\draw (0,2) to [short, -*] (-0.6,2);
\draw (0,0) to [short, -*] (-0.6,0);
\draw[line width=0.4mm] (-0.6,2.5) to [short] (-0.6,-0.5);
\draw[line width=0.4mm] (-1.5,2.5) to [short] (-1.5,-0.5);
\draw[line width=0.4mm] (-1.5,2.5) to [short] (-0.6,2.5);
\draw[line width=0.4mm] (-1.5,-0.5) to [short] (-0.6,-0.5);
\node[rotate=00] at (-1.05,1.0) {DC syst.};

\draw (1.75,2.25) to [controlled sinusoidal voltage source, l=$\underline{V}_v$] (3.0,2.25);
\draw (1.75,1) to [controlled sinusoidal voltage source, *-] (3.0,1);
\draw (1.75,-0.25) to [controlled sinusoidal voltage source] (3.0,-0.25);
\draw (1.75,2.25) to [short] (1.75,-0.25);

\draw (3.0,1) to [R, european] (4.2,1);
\draw (4.4,1) to [R, european] (5.7,1);
\draw (4.2,1) to [short] (4.4,1);
\draw (5.7,1) to [sV, -*] (6.8,1);

\draw (3.0,2.25) to [R, european, l=$\underline{Z}_z$] (4.2,2.25);
\draw (4.4,2.25) to [R, european, l=$\underline{Z}_t$] (5.7,2.25);
\draw (4.2,2.25) to [short] (4.4,2.25);
\draw (5.7,2.25) to [sV, l=$\underline{V}_t$] (6.8,2.25);

\draw (3.0,-0.25) to [R, european] (4.2,-0.25);
\draw (4.4,-0.25) to [R, european, l=$\underline{Z}_t$] (5.7,-0.25);
\draw (4.2,-0.25) to [short] (4.4,-0.25);
\draw (5.7,-0.25) to [sV] (6.8,-0.25);
\draw (6.8,2.25) to [short] (6.8,-0.25);

\draw[line width=0.4mm, dotted] (4.4,3.05) to [short] (4.4,-0.9);
\draw[line width=0.4mm, dotted] (4.4,3.05) to [short] (6.95,3.05);
\draw[line width=0.4mm, dotted] (4.4,-0.9) to [short] (6.95,-0.9);
\draw[line width=0.4mm, dotted] (6.95,3.05) to [short] (6.95,-0.9);

\draw[line width=0.4mm, dotted] (0.5,3.05) to [short] (0.5,-0.9);
\draw[line width=0.4mm, dotted] (0.5,3.05) to [short] (4.3,3.05);
\draw[line width=0.4mm, dotted] (4.3,3.05) to [short] (4.3,-0.9);
\draw[line width=0.4mm, dotted] (0.5,-0.9) to [short] (4.3,-0.9);

\draw (2.5,-1.3) to [sdcac] (2.5,-2.3);
% \draw (2.0, -1.3) to [short] (0.5, -0.9);
% \draw (3.0, -1.3) to [short] (4.3, -0.9);
\node[rotate=-90] at (2.5,-1.12) {$\equiv$};

\node at (2.5,3.2) {VSC average model};
\node at (5.6375,3.15) {Grid};


\end{circuitikz}
\caption{Average model of a VSC connected to the grid}
\label{fig:average_model}
\end{figure}

Power systems are likely to involve more than a single converter. Therefore, the modeling is approached from a generalized perspective. Figure \ref{fig:sys_n} presents the modeling for a system with $n$ converters. They are connected to a grid which has been split into a passive part, only formed by impedances and denoted by its admittance matrix $\mathbf{\un{Y}_g}$, and an active part, modeled with a Norton equivalent. Compared to dealing with a Thevenin equivalent, the Norton equivalent simplifies the formulation since it does not create an additional bus. The VSCs are treated as current sources that inject currents of the form of $\un{I}_k\forall k\in[1,...,n]$. Additional impedances denoted by $\un{Z}_{vk}$ connect the point of common coupling to the grid. Such point of common coupling is precisely where the voltages ought to be improved. 

\begin{figure}[] \centering \tiny
\begin{circuitikz}[american]
\thicklines

\draw (-2.75,2) to [isource, l_=$\underline{I}_{t}$] (-4.25,2);
\draw (-4.25,0.7) to [R, l=$\underline{Z}_{t}$, european] (-2.75,0.7);
\draw (-2.75,2) to [short] (-2.75,0.7);
\draw (-4.25,2) to [short] (-4.25,0.7);
\draw (-4.25,1.35) to [short, *-*] (-4.5,1.35);
\draw (-2.75,1.35) to [short, *-] (-2.5,1.35);
\draw (-2.5,1.35) to [short] (-2.5,0);
\draw (-2.75,0) to [short] (-2.25,0);

\node at (-8,1.3) {PCC1};
\node at (-9.5,2.6) {VSC1};
\node at (-8,2.7) {$\underline{V}_{p1}$};
\draw (-7.5,2) to [R, l=$\underline{Z}_{v1}$, european] (-6,2);
\draw[line width=0.65mm] (-8,2.5) to [short] (-8,1.5);
% \draw[line width=0.65mm] (-3,2.5) to [short] (-3,1.5);
% \node at (-3,2.7) {$\underline{V}_{f}$};
% \draw (-9,2) to [R, l=$\underline{Z}_{z1}$, i=$\underline{I}_1$, european] (-7.0,2);
\draw (-10.0,2) to [sdcac] (-9.0,2);
\draw (-6,2) to [short, -*] (-5.5,2); 

\draw (-10.0,-0) to [sdcac] (-9.0,-0);
% \draw (-9,-0) to [R, l=$\underline{Z}_{z2}$, i=$\underline{I}_2$, european] (-7,-0);
\draw (-7.5,-0) to [R, l=$\underline{Z}_{v2}$, european] (-6,-0);
\draw[line width=0.65mm] (-8,0.5) to [short] (-8,-0.5);
\node at (-8,-0.7) {PCC2};
\node at (-9.5,0.6) {VSC2};
\node at (-8,0.7) {$\underline{V}_{p2}$};
\draw (-6,0) to [short, -*] (-5.5,0); 
\draw (-7.5,2) to [short] (-8,2);
\draw (-7.5,0) to [short] (-8,0);
\draw (-7.5,-2) to [short] (-8,-2);

\draw (-9,2) to [short, i=$\un{I}_1$] (-8,2);
\draw (-9,0) to [short, i=$\un{I}_2$] (-8,0);
\draw (-9,-2) to [short, i=$\un{I}_3$] (-8,-2);

\draw (-10.0,-2) to [sdcac] (-9.0,-2);
% \draw (-9,-2) to [R, l=$\underline{Z}_{zn}$, i=$\underline{I}_n$, european] (-7,-2);
\draw (-7.5,-2) to [R, l=$\underline{Z}_{vn}$, european] (-6,-2);
\draw[line width=0.65mm] (-8,-1.5) to [short] (-8,-2.5);
\node at (-8,-2.7) {PCCn};
\node at (-9.5,-1.4) {VSCn};
\node at (-8,-1.3) {$\underline{V}_{pn}$};
\draw (-6,-2) to [short, -*] (-5.5,-2); 

\draw[line width=0.4mm] (-4.5,2.5) to [short] (-4.5,-2.5);
\draw[line width=0.4mm] (-5.5,2.5) to [short] (-5.5,-2.5);
\draw[line width=0.4mm] (-4.5,2.5) to [short] (-5.5,2.5);
\draw[line width=0.4mm] (-5.5,-2.5) to [short] (-4.5,-2.5);
\node at (-5,0.0) {Grid $\mathbf{\un{Y}_g}$};

\draw[line width=0.4mm, dotted] (-9.5,-0.6) to [short] (-9.5,-1.1);
% \draw[line width=0.4mm, dotted] (-8.0,-0.3) to [short] (-8.0,-1.4);
\draw[line width=0.4mm, dotted] (-6.75,-0.3) to [short] (-6.75,-1.4);

\end{circuitikz}
\caption{Single-phase representation of a complete system}
\label{fig:sys_n}
\end{figure}

The relationship between currents and voltages can be established with an analysis in the natural reference frame or by employing symmetrical components as in \cite{taul2020modeling}. Although both approaches are equally valid, working in the natural reference frame allows studying the system with greater flexibility, as only the particular elements of the admittance matrices that depend on the fault admittance experience changes. No other modifications in the topology have to be considered. Consequently, voltages and currents are related by
\begin{equation}
\setlength\arraycolsep{1.5pt}
    \begin{split}
    \begin{pmatrix}
        \mathbf{\underline{I}_1} \\
        \mathbf{\underline{I}_2} \\
        \vdots\\
        \mathbf{\underline{I}_n} \\
        \mathbf{\un{I}_t}
    \end{pmatrix} = 
\begin{pmatrix}
    \mathbf{\un{Y}_{v1}} & \mathbf{0} & \dots & \mathbf{0} & -\mathbf{\un{Y'}_{v1}}\\
    \mathbf{0} & \mathbf{\un{Y}_{v2}} & \dots & \mathbf{0} & -\mathbf{\un{Y'}_{v2}}\\
    \vdots & \vdots & \ddots & \vdots & \vdots \\
    \mathbf{0} & \mathbf{0} & \dots & \mathbf{\un{Y}_{vn}} & -\mathbf{\un{Y'}_{vn}}\\
    -\mathbf{\un{Y'}^T_{v1}} & -\mathbf{\un{Y'}^T_{v2}} & \dots & -\mathbf{\un{Y'}^T_{vn}} & \mathbf{\un{Y}_g}
    % -\mathbf{\un{Y}_{v1}} & -\mathbf{\un{Y}_{v2}} & \mathbf{\un{Y}_{f}}\\
\end{pmatrix}
\begin{pmatrix}
    \mathbf{\un{V}_{p1}} \\
    \mathbf{\un{V}_{p2}} \\
    \vdots \\
    \mathbf{\un{V}_{pn}} \\
    \mathbf{\un{V}_g}
\end{pmatrix}.
\end{split}
\label{eq:nconv}
\end{equation}
For a given converter $k$, its injected currents and its associated voltages at the point of common coupling are further developed as 
\begin{equation}
  \begin{cases}
    \mathbf{\un{I}_k} = \left[\un{I}^{(a)}_k, \un{I}^{(b)}_k, \un{I}^{(c)}_k \right]^T \\
    \mathbf{\un{V}_{pk}} = [\un{V}^{(a)}_{pk}, \un{V}^{(b)}_{pk}, \un{V}^{(c)}_{pk}]^T 
  \end{cases}
\end{equation}
i.e., they contain the $a$, $b$ and $c$ phase values. Voltages and currents are related via admittance matrices of the form $\mathbf{\un{Y}_{vk}}$, which in normal operating conditions follow
\begin{equation}
  \mathbf{\un{Y}_{vk}} = \begin{pmatrix}
   \frac{1}{\un{Z}_{vk}} & 0 & 0 \\
   0 & \frac{1}{\un{Z}_{vk}} & 0 \\
   0 & 0 & \frac{1}{\un{Z}_{vk}} \\
  \end{pmatrix} \ .
\end{equation} 
In case a fault occurs at the buses interconnected by $\un{Z}_{vk}$, elements $1/\un{Z}_f$ are added by observation, where $\un{Z}_f$ denotes the fault impedance. 

On the contrary, the admittance matrix $\mathbf{\un{Y}_g}$ is a $3n_g \times 3n_g$ matrix also built by observation. The object $\mathbf{\un{I}_t}$ is a vector of dimensions $3\times n_g$ which accounts for the injected currents into the grid denoted by $\mathbf{\un{Y}_g}$. All its elements are null except for three entries that consider the injected currents from the Norton equivalent of the grid. Matrices of the form $\mathbf{\un{Y'}_{vk}}$ are $3\times 3n_g$ objects constituted by elements $1/\un{Z}_{vk}$. In a realistic scenario, the grid $\mathbf{\un{Y}_g}$ may be partially constitued by active and reactive power loads, i.e., PQ buses. They can be either ignored if the current they consume is assessed to be comparatively smaller than the fault current, or they can be modeled as constant admittances. No PQ loads have been considered in the case studies shown in this paper. 

The final goal of the modeling is the obtention of voltages. They are computed from \eqref{eq:nconv} by operating the product between the inverse of the full admittance matrix and the currents' vector. 
In order to have a clearer comprehension of the voltages, they are eventually converted into symmetrical components by means of Fortescue's transformation\cite{fortescue1918method}:
\begin{equation}
  \begin{pmatrix}
    \un{V}^{0}_{pk} \\
    \un{V}^{+}_{pk} \\
    \un{V}^{-}_{pk} \\
  \end{pmatrix} = \frac{1}{3} \begin{pmatrix}
    1 & 1 & 1\\
    1 & a & a^{2}\\
    1 & a^{2} & a\\
  \end{pmatrix} \begin{pmatrix}
    \un{V}^{a}_{pk} \\
    \un{V}^{b}_{pk} \\
    \un{V}^{c}_{pk} \\
  \end{pmatrix}\ ,
\end{equation}
where $a=e^{j\frac{2\pi}{3}}$. 

\subsection{Optimization problem}
Positive sequence voltages have to be maximized while negative sequence voltages have to be minimized. The zero sequence component of the voltages is a magnitude likely to become non-null under asymmetrical faults. Nevertheless, as VSC are unable to inject zero sequence currents, it will remain an uncontrolled variable in the sense that no efforts will be made towards reducing it. Current saturation restrictions imposed by the VSC characteristics have to be respected. This applies to each phase of each converter. Therefore, the generic optimization problem is
\begin{equation}
\begin{aligned}
\min_{\un{I}} \quad & \sum_{k=1}^n\left[\lambda_k^+|(1 - |\un{V}^+_{pk}(\un{I}) |)| + \lambda^-_k|(0 - |\un{V}^-_{pk}(\un{I})|)|\right] \ , \\
\textrm{s.t.} \quad & \text{max}(\un{I}^{a}_k, \un{I}^{b}_k, \un{I}^{c}_k) \leq I_{\text{max,k}} \ \forall k \in [1,...,n] \ ,\\
  &\un{I}^a_k + \un{I}^b_k + \un{I}^{c}_k = 0 \ \forall k \in [1,...,n] \ , \\
\end{aligned}
\label{eq:opt2}
\end{equation}
where the positive and negative sequence components of voltages $\un{V}_{pk}$ are symbolically expressed as functions of the currents, and $I_{\text{max,k}}$ is the maximum allowed current by the $k$ converter. It has been assumed that voltages at each phase of the converter do not surpass the limitations, which seems a fair assumption considering that voltages decreases substantially during faults. Ignoring voltage limitations tends to be a commonality in the literature as well. 

The results gathered in this paper are computed with Python 3.9.1 and the aid of the Mystic package, a highly-constrained non-convex optimization framework \cite{mckerns2012building, mckernsmystic}. A differential global optimization solver has been employed with a relative precision up to $1e-6$. 

\subsection{Grid code rules}
In order to improve voltages during faults, grid code control rules typically impose injections of currents proportional to the voltage drop \cite{nationalgrid, mohseni2012review}. When defined as piecewise functions, for the positive sequence
\begin{equation}
\begin{cases} 
      |\un{I}^+_k| = 0 & |\un{V}^+_{pk}|\geq 0.9  \\
      |\un{I}^+_k| = k_p(0.9 - |\un{V}^+_{pk}|) & 0.5 \leq |\un{V}^+_{pk}| < 0.9 \\
      |\un{I}^+_k| = 1 & |\un{V}^+_{pk}| < 0.5  \\
   \end{cases}
\end{equation}
whereas for the negative sequence
\begin{equation}
\begin{cases} 
      |\un{I}^-_k| = 0 & |\un{V}^-_{pk}|\leq 0.1 \\
      |\un{I}^-_k| = k_n(|\un{V}^-_{pk}| - 0.1) & 0.1 \leq |\un{V}^-_{pk}| < 0.5 \\
      |\un{I}^-_k| = 1 & |\un{V}^-_{pk}| > 0.5 \\
   \end{cases}
\end{equation}
Constants $k_p$ and $k_n$ are initially set at 2.0. If necessary, they are dynamically adjusted so that no current limitations are exceeded. 

% \begin{equation}
% \begin{aligned}
% \min_{\un{I}} \quad & \lambda^+|(1 - |\un{V}^+_p(\un{I}) |)| + \lambda^-|(0 - |\un{V}^-_p(\un{I})|)| \ , \\
% \textrm{s.t.} \quad & \text{max}(\un{I}^{a}, \un{I}^{b}, \un{I}^{c}) \leq I_{\text{max}} \ ,\\
%   &\un{I}^a + \un{I}^b + \un{I}^{c} = 0 \ , \\
% \end{aligned}
% \label{eq:opt1}
% \end{equation}
% where the positive and negative sequence components of voltage $\un{V}_p$ are symbolically expressed as functions of the currents, and $I_{\text{max}}$ is the maximum allowed current by the converter. Considering that faults are strong enough so that the converter is incapable of raising the voltage $|\un{V}^{+}_p(\un{I})|$ to values higher than the maximum allowed voltage, the optimization problem can be rewritten:
% \begin{equation}
% \begin{aligned}
% \min_{\un{I}} \quad & \sum_{k=1}^n\left[\lambda_k^+(1 - |\un{V}^+_{pk}(\un{I}) |) + \lambda^-_k(0 - |\un{V}^-_{pk}(\un{I})|)\right] \ , \\
% \textrm{s.t.} \quad & \text{max}(\un{I}^{a}_k, \un{I}^{b}_k, \un{I}^{c}_k) \leq I_{\text{max,k}} \ \forall k \ ,\\
%   &\un{I}^a_k + \un{I}^b_k + \un{I}^{c}_k = 0 \ \forall k \ . \\
% \end{aligned}
% \label{eq:opt2}
% \end{equation}
% Removing the outer absolute values has been proved to be beneficial in terms of computational time. 





% \subsection{Two-converter case}

% place figure of the two-converter case

% basically put equations, talk about the package to optimize. Maybe this section will be rather short.


\section{Single converter case study} \label{1conv}
The analysis is first performed considering a one-converter case study as the one depicted in Figure \ref{fig:sys_p1}. A fault is caused at the point of connection of the grid. The impedances that model the fault are set accordingly to the type of fault, i.e., balanced or unbalanced (line to ground, line to line or double line to ground). The goal is to improve the voltage $\un{V}_{p1}$ by injecting the optimal $\un{I}^a_1$, $\un{I}^b_1$ and $\un{I}^c_1$ currents.

Three parametric studies are performed. One considers variations in the fault impedance. This case is explicitly described in order to exemplify the formulation. Another study analyzes a varying $R_1/X_1$ ratio, i.e., the proportion between the resistive and the inductive parts that compose the impedance $\un{Z}_{v1}$ is modified while the absolute value of the impedance is kept constant. The third case presents the effect of increasing the distance of a hypothetical submarine cable. 

\begin{figure}[] \centering \tiny
\begin{circuitikz}[american]
\thicklines

\draw (-0.5,2) to [isource, l_=$\underline{I}_{t}$] (-2,2);
\draw (-2,0.7) to [R, l=$\underline{Z}_{t}$, european] (-0.5,0.7);
\draw (-2,0.7) to [short] (-2,2);
\draw (-0.5,0.7) to [short] (-0.5,2);
\draw (-0.5,1.35) to [short, *-] (-0.25,1.35);
\draw (-0.25,1.35) to [short] (-0.25,0);
\draw (-0.5,0) to [short] (-0.0,0);
\draw (-2.0,1.35) to [short, *-] (-2.5,1.35);

\draw[line width=0.65mm] (-2.5,0.85) to [short] (-2.5,1.85);
\draw (-2.5,1.35) to [short] (-2.3,0.35);
\draw (-2.3,0.35) to [short] (-2.7,0.35);
\draw[-{Latex[length=3mm]}] (-2.7,0.35) to [short] (-2.5,-0.65);
\draw (-2.75,-0.65) to [short] (-2.25,-0.65);

% \draw (-3.25, 1.35) to [short] (-3.75, 1.35);
\draw (-2.5, 1.35) to [R, l_=$\un{Z}_{v1}$, european] (-5.0, 1.35);
\draw (-5,1.35) to [short] (-5.125, 1.35);
% \draw (-6.875, 1.35) to [R, l=$\un{Z}_{z1}$, european] (-5.625, 1.35);
% \draw (-6.875, 1.35) to [short] (-5.625, 1.35);
\draw[line width=0.65mm] (-5.0,1.85) to [short] (-5.0,0.85);
\draw (-5.8, 1.35) to [sdcac] (-6.8, 1.35);
\node at (-6.8,1.95) {VSC1};
\node at (-5.0,2.05) {$\underline{V}_{p1}$};
\draw (-5.8,1.35) to [short, i=$\un{I}_1$] (-5.0,1.35);

\node at (-2.5,2.05) {$\underline{V}_{f}$};

\end{circuitikz}
\caption{Single-phase representation of the single converter system under study}
\label{fig:sys_p1}
\end{figure}

% \subsection{Exemplification}
\subsection{Fault impedance variation analysis}
For a single converter system as the one depicted in Figure \ref{fig:sys_p1}, the fault impedance connected to the bus at voltage $\un{V}_f$ is responsible for identify the fault. Explicitly, voltages and currents are related by
\begin{equation}
  \begin{pmatrix}
    \un{I}^{a}_1 \\
    \un{I}^{b}_1 \\
    \un{I}^{c}_1 \\
    \un{I}^{a}_t \\
    \un{I}^{b}_t \\
    \un{I}^{c}_t \\
  \end{pmatrix} = 
 \left(\mathbf{\un{Y}_{v}} + \mathbf{\un{Y}_f}\right) 
\begin{pmatrix}
    \un{V}^{a}_{p1} \\
    \un{I}^{b}_{p1} \\
    \un{I}^{c}_{p1} \\
    \un{I}^{a}_f \\
    \un{I}^{b}_f \\
    \un{I}^{c}_f \\
  \end{pmatrix} ,
\end{equation}
where the admittance matrix has been split into two parts: $\mathbf{\un{Y}_v}$ represents the non-faulted admittance matrix of the system, whereas $\mathbf{\un{Y}_f}$ is constitued by the admittances that intervene in the fault. This way, the admittance matrices are defined as
\begin{equation}\scriptsize
  \mathbf{\un{Y}_v} = \begin{pmatrix}
    \un{Y}_{v1} & 0 & 0 & -\un{Y}_{v1} & 0 & 0\\
    0 & \un{Y}_{v1} & 0 & 0 & -\un{Y}_{v1} & 0\\
    0 & 0 & \un{Y}_{v1} & 0 & 0 & -\un{Y}_{v1}\\
    - \un{Y}_{v1} & 0 & 0 & \un{Y}_{v1} + \un{Y}_t & 0 & 0\\
    0 & - \un{Y}_{v1} & 0 & 0 & \un{Y}_{v1} + \un{Y}_t & 0\\
    0 & 0 & - \un{Y}_{v1} & 0 & 0 & \un{Y}_{v1} + \un{Y}_t\\
  \end{pmatrix}
\end{equation}
where $\un{Y}_{v1}=1/\un{Z}_{v1}$ and $\un{Y}_t=1/\un{Z}_t$. 

On the other hand, the fault admittance $\mathbf{\un{Y}_f}$ is fully dependent on the fault and therefore, it is built by observation. The optimization problem for the one case converter reads 
\begin{equation}
\begin{aligned}
\min_{\un{I}^{a}_1, \un{I}^{b}_1, \un{I}^{c}_1} \quad & \lambda^+_1|(1 - |\un{V}^+_{p1}(\un{I}^a_1, \un{I}^b_1, \un{I}^c_1)|)| \\
 &+ \lambda^-_1|(0 - |\un{V}^-_{pk}(\un{I}^a_1, \un{I}^b_1, \un{I}^c)|)| \ , \\
\textrm{s.t.} \quad & \text{max}(\un{I}^{a}_1, \un{I}^{b}_1, \un{I}^{c}_1) \leq I_{\text{max,1}} \ ,\\
  &\un{I}^a_1 + \un{I}^b_1 + \un{I}^{c}_1 = 0 \ , \\
\end{aligned}
\label{eq:opt_1c}
\end{equation}

% put the algorithm 


\subsection{$R/X$ variation analysis}

\subsection{Cable length variation analysis}
The methodology to optimize voltages under a given fault is shortly described with the intention of presenting the main steps involved. 

% \subsection{Basic system results}
Unless noted otherwise, the corresponding baseline parameters are indicated in Table \ref{tab:param}. 
\begin{table}\centering
  \caption{System parameters for the one-converter case}
  \begin{tabular}{cc}
    \hline
    Parameter & Value \\
    \hline
     $\un{V}_t$ & $1.00$ \\
     $I_{\text{max}}$ & $1.00$ \\
     $\un{Z}_{v1}$ & $0.01+j0.05$ \\
    %  $\un{Z}_{v2}$ & $0.01+j0.06$ \\
     $\un{Z}_{t}$ & $0.01+j0.1$ \\
     $[\lambda_1^+, \lambda_1^-]$ & $[1,1]$\\
     \hline
  \end{tabular}
  \label{tab:param}
\end{table}

\begin{figure}[] \centering \tiny
\begin{circuitikz}[american]
\thicklines

\draw (-0.5,2) to [isource, l_=$\underline{I}_{t}$] (-2,2);
\draw (-2,0.7) to [R, l=$\underline{Z}_{t}$, european] (-0.5,0.7);
\draw (-2,0.7) to [short] (-2,2);
\draw (-0.5,0.7) to [short] (-0.5,2);
\draw (-0.5,1.35) to [short, *-] (-0.25,1.35);
\draw (-0.25,1.35) to [short] (-0.25,0);
\draw (-0.5,0) to [short] (-0.0,0);
\draw (-2.0,1.35) to [short, *-] (-2.2,1.35);

\draw (-3.5,1.35) to [short] (-3.25,1.35);
\draw[line width=0.25mm] (-3.25,1.35) ellipse (0.05 and 0.1);
% \draw[line width=0.25mm] (-2.25,1.35) ellipse (0.05 and 0.1);
\draw[line width=0.25mm] (-3.25,1.45) to [short] (-2.25,1.45);
\draw[line width=0.25mm] (-3.25,1.25) to [short] (-2.25,1.25);
\node at (-2.75,1.55) {cable};
\draw[line width=0.25mm] (-2.25,1.25) arc(-90:90:0.05 and 0.1);

\draw[line width=0.65mm] (-3.5,0.85) to [short] (-3.5,1.85);
\draw (-3.5,1.35) to [short] (-3.35,0.35);
\draw (-3.35,0.35) to [short] (-3.75,0.35);
\draw[-{Latex[length=3mm]}] (-3.75,0.35) to [short] (-3.55,-0.65);
\draw (-3.80,-0.65) to [short] (-3.30,-0.65);

\draw (-6.3, 1.35) to [short, i=$\un{I}_1$] (-5.5, 1.35);
% \draw (-3.25, 1.35) to [short] (-3.75, 1.35);
\draw (-3.9,1.35) to [short] (-3.5,1.35);
\draw (-3.9, 1.35) to [R, l_=$\un{Z}_{v1}$, european] (-5.0, 1.35);
\draw (-5,1.35) to [short] (-5.125, 1.35);
% \draw (-5.625, 1.35) to [short, i=$\un{I}_1$] (-5.125, 1.35);
% \draw (-6.875, 1.35) to [R, l=$\un{Z}_{z1}$, european] (-5.625, 1.35);
\draw[line width=0.65mm] (-5.5,1.85) to [short] (-5.5,0.85);
\draw (-5.5,1.35) to [short] (-5.125, 1.35);
% \draw (-6.875, 1.35) to [short] (-7.125, 1.35);
\draw (-6.3, 1.35) to [sdcac] (-7.3, 1.35);
\node at (-6.8,1.95) {VSC1};
\node at (-5.5,2.05) {$\underline{V}_{p1}$};

\node at (-3.5,2.05) {$\underline{V}_{f}$};

\end{circuitikz}
\caption{Single-phase representation of the single converter connected to a system with a cable}
\label{fig:sys_c1}
\end{figure}


% \subsection{Cable system results}
% extract plots with R/X variation. 
% then extract results for cable distance
% plot everything
% write more


\section{Two converter case study} \label{2conv}
Fill this

\subsection{Fault impedance variation analysis}
\subsection{$R/X$ variation analysis}

\begin{figure}[] \centering \tiny
\begin{circuitikz}[american]
\thicklines

\draw (-0.5,2) to [isource, l_=$\underline{I}_{t}$] (-2,2);
\draw (-2,0.7) to [R, l=$\underline{Z}_{t}$, european] (-0.5,0.7);
\draw (-2,0.7) to [short] (-2,2);
\draw (-0.5,0.7) to [short] (-0.5,2);
\draw (-0.5,1.35) to [short, *-] (-0.25,1.35);
\draw (-0.25,1.35) to [short] (-0.25,0);
\draw (-0.5,0) to [short] (-0.0,0);
\draw (-2.0,1.35) to [short, *-] (-2.5,1.35);

\draw[line width=0.65mm] (-2.5,0.85) to [short] (-2.5,1.85);
\draw (-2.5,1.35) to [short] (-2.3,0.35);
\draw (-2.3,0.35) to [short] (-2.7,0.35);
\draw[-{Latex[length=3mm]}] (-2.7,0.35) to [short] (-2.5,-0.65);
\draw (-2.75,-0.65) to [short] (-2.25,-0.65);

\draw (-2.5,1.6) to [short] (-3.25, 1.6);
\draw (-2.5,1.05) to [short] (-3.25, 1.05);
\draw (-3.25, 1.6) to [short] (-3.25, 2.1);
\draw (-3.25, 1.05) to [short] (-3.25, 0.55);

\draw (-3.25, 0.55) to [short] (-3.75, 0.55);
\draw (-3.75, 0.55) to [R, l_=$\un{Z}_{v2}$, european] (-5.0, 0.55);
\draw (-5,0.55) to [short] (-5.125, 0.55);
\draw (-6.3, 0.55) to [short, i=$\un{I}_2$] (-5.5, 0.55);
% \draw (-6.875, 0.55) to [R, l=$\un{Z}_{z2}$, european] (-5.625, 0.55);
% \draw (-6.875, 0.55) to [short] (-5.625, 0.55);
\draw[line width=0.65mm] (-5.5,0.05) to [short] (-5.5,1.05);
% \draw (-6.875, 0.55) to [short] (-7.125, 0.55);
\draw (-6.3, 0.55) to [sdcac] (-7.3, 0.55);
\draw (-5.5, 0.55) to [short] (-5.0, 0.55);
\node at (-6.8,1.15) {VSC2};
\node at (-5.5,1.25) {$\underline{V}_{p2}$};

\draw (-3.25, 2.1) to [short] (-3.75, 2.1);
\draw (-3.75, 2.1) to [R, l_=$\un{Z}_{v1}$, european] (-5.0, 2.1);
\draw (-5,2.1) to [short] (-5.125, 2.1);
\draw (-6.3, 2.1) to [short, i=$\un{I}_1$] (-5.5, 2.1);
\draw (-5.5, 2.1) to [short] (-5.0, 2.1);
% \draw (-6.875, 2.1) to [R, l=$\un{Z}_{z1}$, european] (-5.625, 2.1);
% \draw (-6.875, 2.1) to [short] (-5.625, 2.1);
\draw[line width=0.65mm] (-5.5,1.6) to [short] (-5.5,2.6);
\draw (-5.8, 2.1) to [short] (-6.3, 2.1);
\draw (-6.3, 2.1) to [sdcac] (-7.3, 2.1);
\node at (-6.8,2.7) {VSC1};
\node at (-5.5,2.80) {$\underline{V}_{p1}$};

\node at (-2.5,2.05) {$\underline{V}_{f}$};

\end{circuitikz}
\caption{Single-phase representation of the two-converter system under study}
\label{fig:sys_p2}
\end{figure}

\begin{table}\centering
  \caption{System parameters for the two converter case}
  \begin{tabular}{cc}
    \hline
    Parameter & Value \\
    \hline
     $\un{V}_t$ & $1.00$ \\
     $I_{\text{max}}$ & $1.00$ \\
     $\un{Z}_{v1}$ & $0.01+j0.05$ \\
     $\un{Z}_{v2}$ & $0.01+j0.06$ \\
     $\un{Z}_{t}$ & $0.01+j0.1$ \\
     $[\lambda_1^+, \lambda_1^-, \lambda_2^+, \lambda_2^-]$ & $[1, 1, 1, 1]$\\
     \hline
  \end{tabular}
  \label{tab:param2}
\end{table}


\input{Plots/Z_1conv.tex}
\input{Plots/RX_1conv.tex}
\input{Plots/Z_2conv.tex}
\input{Plots/RX_2conv.tex}


\newpage
\clearpage



\section{Conclusion}\label{concl}
Fill this






% if have a single appendix:
%\appendix[Proof of the Zonklar Equations]
% or
%\appendix  % for no appendix heading
% do not use \section anymore after \appendix, only \section*
% is possibly needed

% use appendices with more than one appendix
% then use \section to start each appendix
% you must declare a \section before using any
% \subsection or using \label (\appendices by itself
% starts a section numbered zero.)
%


% \appendices
% \section{Proof of the First Zonklar Equation}
% Appendix one text goes here.

% % you can choose not to have a title for an appendix
% % if you want by leaving the argument blank
% \section{}
% Appendix two text goes here.


% use section* for acknowledgment
\section*{Acknowledgment}
Fill this.


% Can use something like this to put references on a page
% by themselves when using endfloat and the captionsoff option.
\ifCLASSOPTIONcaptionsoff
  \newpage
\fi



% trigger a \newpage just before the given reference
% number - used to balance the columns on the last page
% adjust value as needed - may need to be readjusted if
% the document is modified later
%\IEEEtriggeratref{8}
% The "triggered" command can be changed if desired:
%\IEEEtriggercmd{\enlargethispage{-5in}}

% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://mirror.ctan.org/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)

\bibliographystyle{IEEEtran}  
\bibliography{bib}  


% biography section
% 
% If you have an EPS/PDF photo (graphicx package needed) extra braces are
% needed around the contents of the optional argument to biography to prevent
% the LaTeX parser from getting confused when it sees the complicated
% \includegraphics command within an optional argument. (You could create
% your own custom macro containing the \includegraphics command to make things
% simpler here.)
%\begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{mshell}}]{Michael Shell}
% or if you just want to reserve a space for a photo:



% \begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Data/v4.png}}]{Josep Fanals i Batllori}
% was born in la Bisbal d'Empordà, Spain, in 1998. He received the B.S. degree in electrical engineering from the Universitat de Girona, Girona, Spain, in 2020. His primary area of interest is the study of techniques to solve the power flow problem.
% \end{IEEEbiography}

% % if you will not have a photo at all:
% \begin{IEEEbiography}[{\includegraphics[width=1in,height=1.25in,clip,keepaspectratio]{Data/foto_SH.jpg}}]{Sergio Herraiz Jaramillo}
% was born in Barcelona, Spain, in 1972. He received the B.S. degree in industrial engineering and the Ph.D. degree in engineering from the Universitat Politècnica de Catalunya, Barcelona, Spain in 1997 and 2002, respectively. Currently, he is a lecturer at the Institute of Informatics and Applications of the Universitat de Girona, Girona, Spain. His research interest is on power quality and energy effiency monitoring in power systems.
% \end{IEEEbiography}

\vfill

% insert where needed to balance the two columns on the last page with
% biographies
%\newpage

% \begin{IEEEbiographynophoto}{Jane Doe}
% Biography text here.
% \end{IEEEbiographynophoto}

% You can push biographies down or up by placing
% a \vfill before or after them. The appropriate
% use of \vfill depends on what kind of text is
% on the last page and whether or not the columns
% are being equalized.

%\vfill

% Can be used to pull up biographies so that the bottom of the last one
% is flush with the other column.
%\enlargethispage{-5in}



% that's all folks
\end{document}


% % testing plots
% \begin{figure}[!htb]\centering \tiny
%     \begin{subfigure}[!htb]{0.12\textwidth}
%       \centering
%           \begin{tikzpicture}[trim axis right,trim axis left]
%               \pgfplotsset{width=4.5cm, height=3.5cm}
%               \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^+_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, ytick distance={0.05}, xmin=0.0, xmax=0.95, scaled y ticks=false, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip1re.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip2re.csv};
%               % \legend{BF, OPT};
%               \end{axis}
%           \end{tikzpicture}
%     \end{subfigure}
%     \hspace{2.35cm}
%     \begin{subfigure}[!htb]{0.12\textwidth}
%         \centering
%             \begin{tikzpicture}[trim axis right,trim axis left]
%                 \pgfplotsset{width=4.5cm, height=3.5cm}
%                 \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^+_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, xmin=0.0, xmax=0.95, ytick distance = {0.05}]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip1im.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip2im.csv};
%                 % \legend{OPT};
%                 \end{axis}
%             \end{tikzpicture}
%       \end{subfigure}


%       \begin{subfigure}[!htb]{.12\textwidth}
%         \centering
%             \begin{tikzpicture}[trim axis right,trim axis left]
%                 \pgfplotsset{width=4.5cm, height=3.5cm}
%                 \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^-_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, xmin=0.0, xmax=0.95, ytick distance = {0.05}, ymax = 0.1, ymin=-0.1, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In1re.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In2re.csv};
%                 % \legend{BF, OPT};
%                 \end{axis}
%             \end{tikzpicture}
%       \end{subfigure}
%       \hspace{2.35cm}
%       \begin{subfigure}[!htb]{.12\textwidth}
%           \centering
%               \begin{tikzpicture}[trim axis right,trim axis left]
%                   \pgfplotsset{width=4.5cm, height=3.5cm}
%                   \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^-_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick,  xmin=0.0, xmax=0.95, ytick distance = {0.05}, ymax = 0.1, ymin = -0.1,  yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In1im.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In2im.csv};
%                   \end{axis}
%               \end{tikzpicture}
%         \end{subfigure}


%       \begin{subfigure}[!htb]{.12\textwidth}
%         \centering
%             \begin{tikzpicture}[trim axis right,trim axis left]
%                 \pgfplotsset{width=4.5cm, height=3.5cm}
%                 \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={$|V^+|$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, xmin=0.0, xmax=0.95, ytick distance = {0.002}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vp1.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vp2.csv};
%                 % \legend{BF, OPT};
%                 \end{axis}
%             \end{tikzpicture}
%       \end{subfigure}
%       \hspace{2.35cm}
%       \begin{subfigure}[!htb]{.12\textwidth}
%           \centering
%               \begin{tikzpicture}[trim axis right,trim axis left]
%                   \pgfplotsset{width=4.5cm, height=3.5cm}
%                   \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={$|V^-|$}, /pgf/number format/.cd, legend style={at={(0.98,0.05)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick,  xmin=0.0, xmax=0.95, ytick distance = {0.05},  yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3}, ymax = 0.1, ymin=-0.1]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vn1.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vn2.csv};
%                   \legend{VSC1, VSC2};
%                   \end{axis}
%               \end{tikzpicture}
%         \end{subfigure}


% \begin{center}
% \begin{subfigure}[!htb]{0.4\textwidth}
%           \centering
%               \begin{tikzpicture}[trim axis right,trim axis left]
%                   \pgfplotsset{width=9.4cm, height=3.51cm}
%                   \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={$f$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.1}, axis line style = thick,  xmin=0.0, xmax=0.95, ytick distance = {0.1},  yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_f_obj.csv};
%                   \end{axis}
%               \end{tikzpicture}
%         \end{subfigure}
%     \end{center}
%     \caption{Influence of the currents on the objective function for the balanced fault with a changing $\lambda_1$ and $\un{Y}_{xg}=5$}
%     \label{fig:3x_fault3}
%   \end{figure}

% \begin{figure}[!htb]\centering \tiny
%     \begin{subfigure}[!htb]{0.12\textwidth}
%       \centering
%           \begin{tikzpicture}[trim axis right,trim axis left]
%               \pgfplotsset{width=4.5cm, height=3.5cm}
%               \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^+_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, ytick distance={0.05}, xmin=0.0, xmax=0.95, scaled y ticks=false, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip1re.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip2re.csv};
%               % \legend{BF, OPT};
%               \end{axis}
%           \end{tikzpicture}
%     \end{subfigure}
%     \hspace{2.35cm}
%     \begin{subfigure}[!htb]{0.12\textwidth}
%         \centering
%             \begin{tikzpicture}[trim axis right,trim axis left]
%                 \pgfplotsset{width=4.5cm, height=3.5cm}
%                 \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^+_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, xmin=0.0, xmax=0.95, ytick distance = {0.05}]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip1im.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Ip2im.csv};
%                 % \legend{OPT};
%                 \end{axis}
%             \end{tikzpicture}
%       \end{subfigure}


%       \begin{subfigure}[!htb]{.12\textwidth}
%         \centering
%             \begin{tikzpicture}[trim axis right,trim axis left]
%                 \pgfplotsset{width=4.5cm, height=3.5cm}
%                 \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^-_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, xmin=0.0, xmax=0.95, ytick distance = {0.05}, ymax = 0.1, ymin=-0.1, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In1re.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In2re.csv};
%                 % \legend{BF, OPT};
%                 \end{axis}
%             \end{tikzpicture}
%       \end{subfigure}
%       \hspace{2.35cm}
%       \begin{subfigure}[!htb]{.12\textwidth}
%           \centering
%               \begin{tikzpicture}[trim axis right,trim axis left]
%                   \pgfplotsset{width=4.5cm, height=3.5cm}
%                   \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={${I}^-_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick,  xmin=0.0, xmax=0.95, ytick distance = {0.05}, ymax = 0.1, ymin = -0.1,  yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In1im.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_In2im.csv};
%                   \end{axis}
%               \end{tikzpicture}
%         \end{subfigure}


%       \begin{subfigure}[!htb]{.12\textwidth}
%         \centering
%             \begin{tikzpicture}[trim axis right,trim axis left]
%                 \pgfplotsset{width=4.5cm, height=3.5cm}
%                 \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={$|V^+|$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick, xmin=0.0, xmax=0.95, ytick distance = {0.002}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vp1.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vp2.csv};
%                 % \legend{BF, OPT};
%                 \end{axis}
%             \end{tikzpicture}
%       \end{subfigure}
%       \hspace{2.35cm}
%       \begin{subfigure}[!htb]{.12\textwidth}
%           \centering
%               \begin{tikzpicture}[trim axis right,trim axis left]
%                   \pgfplotsset{width=4.5cm, height=3.5cm}
%                   \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={$|V^-|$}, /pgf/number format/.cd, legend style={at={(0.98,0.05)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.2}, axis line style = thick,  xmin=0.0, xmax=0.95, ytick distance = {0.05},  yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3}, ymax = 0.1, ymin=-0.1]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vn1.csv};
%                   \addplot[very thick, red, dashed] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_Vn2.csv};
%                   \legend{VSC1, VSC2};
%                   \end{axis}
%               \end{tikzpicture}
%         \end{subfigure}


% \begin{center}
% \begin{subfigure}[!htb]{0.4\textwidth}
%           \centering
%               \begin{tikzpicture}[trim axis right,trim axis left]
%                   \pgfplotsset{width=9.4cm, height=3.51cm}
%                   \begin{axis}[grid=major, xlabel={$\lambda_1$}, ylabel={$f$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick distance={0.1}, axis line style = thick,  xmin=0.0, xmax=0.95, ytick distance = {0.1},  yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3},]
%                   \addplot[very thick, black] table[x=x, y=y, col sep=comma] {Data/Data3/opt_3x_f_obj.csv};
%                   \end{axis}
%               \end{tikzpicture}
%         \end{subfigure}
%     \end{center}
%     \caption{Influence of the currents on the objective function for the balanced fault with a changing $\lambda_1$ and $\un{Y}_{xg}=5$}
%     \label{fig:3x_fault4}
%   \end{figure}

