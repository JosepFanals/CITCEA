\section{Variable resistance/inductance ratio}
In this section we try to answer to the question of what happens when the $R/X$ ratio varies. This way we experiment with cases where the resistive part is considerably larger than in the aforementioned analysis. The fault impedance $\underline{Z}_f$ has been forced to take real values, which seems realistic.

\subsection{Balanced fault}
Figure \ref{fig:3x1_c} depicts the optimal currents for the balanced fault.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=5.5cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick={0.0, 0.2,...,1.0}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_re_3x.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_re_3x.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_re_3x.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=5.5cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick,  xmin=0, xmax=5]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_im_3x.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_im_3x.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_im_3x.csv};
                % \legend{OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}

      \vspace{0.5cm}

      \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=5.5cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, ymin = -0.5, ymax=0.5, axis line style = thick,  xmin=0, xmax=5]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_re_3x.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_re_3x.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_re_3x.csv};
                % \legend{BF, OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
      \hspace{1.5cm}
      \begin{subfigure}[!htb]{.4\textwidth}
          \centering
              \begin{tikzpicture}[trim axis right,trim axis left]
                  \pgfplotsset{width=7cm, height=5.5cm}
                  \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, ymin = -0.5, ymax=0.5, axis line style = thick,  xmin=0, xmax=5]
                  \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_im_3x.csv};
                  \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_im_3x.csv};
                  \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_im_3x.csv};
                  % \legend{BF, OPT};
                  \end{axis}
              \end{tikzpicture}
        \end{subfigure}

        \vspace{0.2cm}

    \begin{center}
        \begin{subfigure}[!htb]{0.7\textwidth}
                \begin{tikzpicture}[trim axis right,trim axis left]
                    \pgfplotsset{width=12.5cm, height=5.5cm}
                    \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$f$}, /pgf/number format/.cd, legend style={at={(0.98,0.2)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,0.5,...,5}, ymin = 0.2, axis line style = thick, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, ytick={0.0,0.1,...,0.5},  xmin=0, xmax=5]
                   \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/ff_3x.csv};
                   \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/Gff_3x.csv};
                   \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/Rff_3x.csv};
                    \legend{OPT, Grid Code, ROPT};
                    \end{axis}
                \end{tikzpicture}
        \end{subfigure}
    \end{center}
    \caption{Influence of the currents on the objective function for the balanced fault with $\underline{Z}_f=0.05$ and a changing $R/X$ ratio. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:3x1_c}
  \end{figure}
It becomes clear that the optimal current is highly dependent on the $R/X$ ratio. That is, when $X>R$, the imaginary positive sequence is dominant, and vice versa for $R>X$. This phenomena makes complete sense when considering that we want to amplify the voltage drop in the positive sequence. However, even when there are serious differences between $R$ and $X$ in magnitude, neither the real nor the imaginary part go to zero. Thus, the objective function for the OPT case becomes slightly lower when compared to the ROPT case. Besides, since the negative sequence equivalent circuit is decoupled from the positive sequence one, the negative sequence currents are null in all cases.  

The grid code behaves in a similar manner with respect to the ROPT situation. The differences are more visible the lower the $R/X$ is, which coincides with a lower $f$ and hence a healthy operation of the system. In other words, when the fault is not too severe, the grid code does not force the converter to inject a maximum current equal to $I_{max}$. The price to pay for that is having an objective function worse than the OPT and the ROPT, even though for large $R/X$ ratios it tends to follow the same trajectory as ROPT.

The fault impedance has a noticeable effect on the results. When it is extremely small, the objective function almost does not vary. Opting for a too large fault impedance may cause the presence of multiple solutions. Hence, the real and imaginary currents may take unexpected values so it is hard to build intuition around the problem. We have checked that $\underline{Z}_f=0.05$ for the balanced fault was a convenient value. 

In addition, Figure \ref{fig:full_RX_3x} shows the absolute value of the voltages depending on the $R/X$ ratio.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=7.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|V^+|$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick distance={0.05}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V1_3x.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV1_3x.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV1_3x.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=7.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|{V}^-|$}, /pgf/number format/.cd, legend style={at={(0.98,0.7)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={-0,1,...,5}, axis line style = thick, xmin=0, xmax=5, ytick distance={0.05}, ymin = -0.1, ymax = 0.1, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V2_3x.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV2_3x.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV2_3x.csv};
                \legend{OPT, GridCode, ROPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
    \caption{Influence of the $R/X$ ratio on the voltages for the balanced fault with $\underline{Z}_f=0.05$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:full_RX_3x}
  \end{figure}

As already noted in Figure \ref{fig:3x1_c}, the objective function for the OPT case is inferior than the one for the ROPT case, and hence, closer to the ideal situation. Nevertheless, independently on having constraints on the active current, the negative sequence voltages remain at exactly zero for all the $R/X$ range. They end up being superposed. The positive sequence voltages, instead, experience some variations depending on the $R/X$ value. The positive sequence voltage trend is the contrary of the objective function pattern. because of the way we have defined the latter.

The best possible situation is having the reactive part larger than the real part of the impedance. This is when the positive sequence voltage tends to 0.75. Since the resistive characteristics of the impedance are so minimized, the ROPT case yields the same results as the OPT. When the resistance increases, the differences are exaggerated due to the fact that no active current can be injected in the ROPT situation.

\subsection{Line to ground fault}
Figure \ref{fig:LGx1_c} depicts the optimal currents for the line to ground fault.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=6.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick={0.0,0.1,...,0.5}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_re_LG.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_re_LG.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_re_LG.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={-0,1,...,5}, axis line style = thick, ytick={-0.5,-0.4,...,0}, xmin=0, xmax=5]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_im_LG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_im_LG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_im_LG.csv};
                % \legend{OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}

      \vspace{0.5cm}

      \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, xmin=0, xmax=5, ytick={-0.6,-0.5,...,-0.0}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_re_LG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_re_LG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_re_LG.csv};
                % \legend{BF, OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
      \hspace{1.5cm}
      \begin{subfigure}[!htb]{.4\textwidth}
          \centering
              \begin{tikzpicture}[trim axis right,trim axis left]
                  \pgfplotsset{width=7cm, height=6.0cm}
                  \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, ytick={-0.2,-0.0,...,1.0}, axis line style =  thick, xmin=0, xmax=5]
                  \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_im_LG.csv};
                  \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_im_LG.csv};
                  \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_im_LG.csv};
                  % \legend{BF, OPT};
                  \end{axis}
              \end{tikzpicture}
        \end{subfigure}

        \vspace{0.2cm}

    \begin{center}
        \begin{subfigure}[!htb]{0.7\textwidth}
                \begin{tikzpicture}[trim axis right,trim axis left]
                    \pgfplotsset{width=12.5cm, height=6.0cm}
                    \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$f$}, /pgf/number format/.cd, legend style={at={(0.98,0.7)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,0.5,...,5}, axis line style = thick, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3}, xmin=0, xmax=5, ytick={0.34, 0.37, ..., 0.45}]
                   \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/ff_LG.csv};
                   \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/Gff_LG.csv};
                   \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/Rff_LG.csv};
                    \legend{OPT, Grid Code, ROPT};
                    \end{axis}
                \end{tikzpicture}
        \end{subfigure}
    \end{center}
    \caption{Influence of the currents on the objective function for the line to ground fault and a changing $R/X$ ratio and $\underline{Z}_f=0.03$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:LGx1_c}
  \end{figure}
The line to ground fault has been analyzed for a fault impedance of $0.03$ because otherwise the fault may not be severe enough. For this type of fault, large $\underline{Z}_f$ brings with it non-smooth changes on currents and voltages. This is precisely what happens around $R/X=4$ for the OPT case. However, it is worth-mentioning that the objective function remains smooth for all range of values. Thus, we are likely to encounter multiple optimal operating points. Notice also that $f$ is not far apart from the objective function in the balanced fault case. Consequently, we are able to conclude that the severity of the fault is similar thanks to the convenient adjustment of the fault impedance.

On the other hand, the differences between the OPT, the ROPT and the Grid Code are relevant. Despite that, there is not much room for improvement in the sense that real currents, for both the positive and negative sequences, take ideally values close to $\pm$0.5 for big enough $R/X$ ratios. Imposing the constraint of not injecting any real current causes that all influence on the voltages is achieved by means of the imaginary currents, which are not enough to improve the voltages up to the same point that the OPT case does. Regarding the Grid Code, the currents to inject in this situation are relatively small. They are far from surpassing the current limitations of the VSC, and despite that, the objective function does not differ much from the ROPT one. Therefore, this suggests that working at $\text{max}(\underline{I}_{abc}) = I_{max}$ is not translated directly into a big improvement.

Even though we can expect that the positive sequence voltage is far from the unit value and the negative sequence is also distant from zero, the evaluation of voltages becomes worth of a particular study. Figure \ref{fig:full_RX_LG} shows the positive and negative sequence voltages for the OPT, the ROPT and the Grid Code.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=7.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|V^+|$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick distance={0.01}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V1_LG.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV1_LG.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV1_LG.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=7.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|{V}^-|$}, /pgf/number format/.cd, legend style={at={(0.98,0.7)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={-0,1,...,5}, axis line style = thick, xmin=0, xmax=5, ytick distance={0.02}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V2_LG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV2_LG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV2_LG.csv};
                \legend{OPT, GridCode, ROPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
    \caption{Influence of the $R/X$ ratio on the voltages for the line to ground fault with $\underline{Z}_f=0.03$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:full_RX_LG}
  \end{figure}
When looking at the bigger picture, the positive sequence voltages in the OPT situation are always above the ROPT ones for about 0.04 pu. The Grid Code positive sequence voltage becomes, however, larger than in the ROPT case. the price to pay for this is a substantial difference in the negative sequence voltages, where the Grid Code one turns out to be the larger. It is relevant to take into account that even if the voltages turn out to be practically constant, the currents experience large variations, as shown in Figure \ref{fig:LGx1_c}. Extracting conclusions regarding the fault by only observing the voltages may be misleading, as they can be maintained at the expense of injecting the specific optimal currents. Besides, just like it happened with the balanced fault, the shape of the objective function ressembles the shape of the voltages. This is logical when considering the proportionality between the objective function and the voltages.


\subsection{Line to line fault}
Figure \ref{fig:LLx1_c} depicts the optimal currents for the line to line fault.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=6.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick={0,0.1,...,0.6}, scaled y ticks=false, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_re_LL.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_re_LL.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_re_LL.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, ytick={-0.7,-0.6,...,0}, axis line style = thick, xmin=0, xmax=5, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_im_LL.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_im_LL.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_im_LL.csv};
                % \legend{OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}

      \vspace{0.5cm}

      \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, ytick={-0.8,-0.7,...,0}, axis line style = thick, xmin=0, xmax=5]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_re_LL.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_re_LL.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_re_LL.csv};
                % \legend{BF, OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
      \hspace{1.5cm}
      \begin{subfigure}[!htb]{.4\textwidth}
          \centering
              \begin{tikzpicture}[trim axis right,trim axis left]
                  \pgfplotsset{width=7cm, height=6.0cm}
                  \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, ytick={0.0,0.2,...,1}, axis line style = thick, xmin=0, xmax=5]
                  \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_im_LL.csv};
                  \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_im_LL.csv};
                  \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_im_LL.csv};
                  % \legend{BF, OPT};
                  \end{axis}
              \end{tikzpicture}
        \end{subfigure}

        \vspace{0.2cm}

    \begin{center}
        \begin{subfigure}[!htb]{0.7\textwidth}
                \begin{tikzpicture}[trim axis right,trim axis left]
                    \pgfplotsset{width=12.5cm, height=6cm}
                    \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$f$}, /pgf/number format/.cd, legend style={at={(0.98,0.7)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,0.5,...,5}, ytick={0.4, 0.5,...,0.9}, axis line style = thick, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5, ytick={0.7,0.74,...,0.82}]
                   \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/ff_LL.csv};
                   \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/Gff_LL.csv};
                   \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/Rff_LL.csv};
                    \legend{OPT, Grid Code, ROPT};
                    \end{axis}
                \end{tikzpicture}
        \end{subfigure}
    \end{center}
    \caption{Influence of the currents on the objective function for the line to line fault and a changing $R/X$ ratio with $\underline{Z}_f=0.03$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:LLx1_c}
  \end{figure}
This time, even if the fault is equally or more severe than in the other cases, the currents take expectable values from an intuitive standpoint. The positive sequence real current is positive to cause a positive voltage drop and improve $\underline{V}^+_c$ (it evolves similarly to the balanced case) while the positive sequence imaginary current becomes negative to provide a resulting positive voltage drop as well. The contrary applies to the negative sequence currents.

The real part of the sequence currents become substantial, even if the $R/X$ takes small values (see the negative sequence real current). In the OPT situation, the increase in the $R/X$ ratio implies an increment on the real positive sequence current and specially a decrease in the negative sequence imaginary current. Contrarily, the ROPT case prioritizes the positive sequence imaginary current for $R/X\approx 1$, but for larger $R/X$ values the negative sequence imaginary current tends to grow up to $I_{max}$. Much of the current capability of the converter is invested in this component. The Grid Code currents remain practically constant for all range of $R/X$ values; both the positive and the negative imaginary sequence currents are equally important.

As visible in the objective function evolution, a consistent variation is present between the OPT and the ROPT case when $R/X$ tends to grow. In further detail, the objective function for the ROPT and the Grid Code increases a bit as a result of being incapable of injecting the much required real currents. This same phenomena happened in a more extreme way for the balanced fault. Differences among the Grid Code and the ROPT are not significant.

Figure \ref{fig:full_RX_LL} displays the absolute value of the positive and negative sequence voltages, which change slightly for various $R/X$ values.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=7.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|V^+|$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick distance={0.02}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V1_LL.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV1_LL.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV1_LL.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=7.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|{V}^-|$}, /pgf/number format/.cd, legend style={at={(0.98,0.7)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={-0,1,...,5}, axis line style = thick, xmin=0, xmax=5, ytick distance={0.02}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V2_LL.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV2_LL.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV2_LL.csv};
                \legend{OPT, GridCode, ROPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
    \caption{Influence of the $R/X$ ratio on the voltages for the line to line fault with $\underline{Z}_f=0.03$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:full_RX_LL}
  \end{figure}

Surprisingly, the positive sequence voltage for the OPT situation is not always higher than in the ROPT case. Thus, for small $R/X$ ratios, which happen to be the most unfavorable, the large injection of positive sequence imaginary current yields higher positive sequence voltages. However, when considering the full objective function, the OPT is always better off than the ROPT. This can be explained with the negative sequence voltages. They are always smaller in the OPT situation compared to the ROPT case. Something similar happens for the Grid Code, although its profile follows a less varying trajectory.  

Also important, in this type of fault the result of the optimization has resulted in obtaining a positive sequence voltage that is approximately equally distant from the unit voltage than the zero voltage is from the negative sequence voltage. That is, $|V^+| + |V^-| \approx 1$ for all range of $R/X$ ratios. Although we were not looking for this balance, the optimization naturally produced it.

\subsection{Double line to ground fault}
Figure \ref{fig:LLGx1_c} depicts the optimal currents for the balanced fault.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=6.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=5}, scaled y ticks=false, xmin=0, xmax=5, ytick={0.0,0.1,...,0.6}]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_re_LLG.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_re_LLG.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_re_LLG.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^+_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=5}, axis line style = thick, xmin=0, xmax=5, ytick={-0.7,-0.6,...,-0.1}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I1_im_LLG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI1_im_LLG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI1_im_LLG.csv};
                % \legend{OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}

      \vspace{0.5cm}

      \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{re}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=5}, scaled y ticks=false, xmin=0, xmax=5, ytick={-0.6,-0.5,...,0}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_re_LLG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_re_LLG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_re_LLG.csv};
                % \legend{BF, OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
      \hspace{1.5cm}
      \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=6.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={${I}^-_{im}$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=5}, scaled y ticks=false, xmin=0, xmax=5, ytick={0, 0.2,...,1.0}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/I2_im_LLG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GI2_im_LLG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RI2_im_LLG.csv};
                % \legend{BF, OPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}

        \vspace{0.2cm}

    \begin{center}
        \begin{subfigure}[!htb]{0.7\textwidth}
                \begin{tikzpicture}[trim axis right,trim axis left]
                    \pgfplotsset{width=12.5cm, height=6cm}
                    \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$f$}, /pgf/number format/.cd, legend style={at={(0.98,0.3)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,0.5,...,5}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=5}, axis line style = thick, xmin=0, xmax=5, ytick={0.94,0.95,...,0.99}]
                   \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/ff_LLG.csv};
                   \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/Gff_LLG.csv};
                   \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/Rff_LLG.csv};
                    \legend{OPT, Grid Code, ROPT};
                    \end{axis}
                \end{tikzpicture}
        \end{subfigure}
    \end{center}
    \caption{Influence of the currents on the objective function for the double line to ground fault and a changing $R/X$ ratio with $\underline{Z}_f=0.5$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:LLGx1_c}
  \end{figure}
The double line to ground fault is expected to become a more severe fault than all the previous cases considered since the connection between the two faulted phases is a solid one. This way, adjusting the fault impedance only affects the connection to ground but the fault remains worrying. As it can be anticipated, the converter has a limited influence on the objective function. Figure \ref{fig:LLGx1_c} shows indeed that such objective function is extremely close to one. The difference between the OPT and the ROPT becomes noticeable again, while the Grid Code is only a bit worse off than the ROPT. The converter is able to inject the optimal currents to keep a constant objective function whereas for the ROPT this does not happen. In the case of the Grid Code, the current profile ressembles the one we obtained of the line to ground fault. 

The real positive and negative sequence currents take similar values (absolutely speaking) when compared to the imaginary parts. In some sense this ressembles the line to line fault findings in the OPT scenario. Major differences ahppen for the negative imaginary sequence current The Grid Code remains rather constant near 0.5, while there is a decrease for the OPT and an increase for the ROPT. Both profiles are near-symmetrical with the Grid Code current as its symmetry axis. 

Figure \ref{fig:full_RX_LLG} shows the distribution of voltages for the multiple $R/X$ ratios. Similar conclusions as before can be extracted.

\begin{figure}[!htb]\centering \footnotesize
    \begin{subfigure}[!htb]{.4\textwidth}
      \centering
          \begin{tikzpicture}[trim axis right,trim axis left]
              \pgfplotsset{width=7cm, height=7.0cm}
              \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|V^+|$}, /pgf/number format/.cd, legend style={at={(0.98,0.15)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={0,1,...,5}, axis line style = thick, ytick distance={0.01}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=2}, xmin=0, xmax=5]
              \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V1_LLG.csv};
              \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV1_LLG.csv};
              \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV1_LLG.csv};
              % \legend{BF, OPT};
              \end{axis}
          \end{tikzpicture}
    \end{subfigure}
    \hspace{1.5cm}
    \begin{subfigure}[!htb]{.4\textwidth}
        \centering
            \begin{tikzpicture}[trim axis right,trim axis left]
                \pgfplotsset{width=7cm, height=7.0cm}
                \begin{axis}[grid=major, xlabel={$R/X$}, ylabel={$|{V}^-|$}, /pgf/number format/.cd, legend style={at={(0.98,0.53)},anchor=south east,legend columns=1, draw=none, inner sep=0pt,fill=gray!10}, xtick={-0,1,...,5}, axis line style = thick, xmin=0, xmax=5, ytick distance={0.005}, yticklabel style={/pgf/number format/fixed, /pgf/number format/precision=3}]
                \addplot[very thick, black] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/V2_LLG.csv};
                \addplot[very thick, red] table[x=x, y=y, meta=label, col sep=comma] {Data/grid_code/GV2_LLG.csv};
                \addplot[very thick, gray, dashed] table[x=x, y=y, meta=label, col sep=comma] {Data/RX/RV2_LLG.csv};
                \legend{OPT, GridCode, ROPT};
                \end{axis}
            \end{tikzpicture}
      \end{subfigure}
    \caption{Influence of the $R/X$ ratio on the voltages for the double line to ground fault with $\underline{Z}_f=0.5$. OPT: solution to the optimization problem, ROPT: solution to the optimization problem restricted to only injecting reactive power.}
    \label{fig:full_RX_LLG}
  \end{figure}
When $R/X$ is approximately null, the positive and negative sequence voltages match for the OPT, the ROPT and the Grid Code cases. However, once the resistive part increases in comparison to the reactive part of the impedance, the impossibility of injecting active current causes a variation in voltages. For the positive sequence voltages, the OPT one is placed above the Grid Code and this is in turn superior to the ROPT voltage. The Grid Code negative sequence voltage grows considerably, whereas the OPT decreases. 
