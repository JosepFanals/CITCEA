\begin{figure}[!htb] \centering 
\begin{circuitikz}[american, scale=1]
\thicklines

\draw (0,0) to [isource, l=$\underline{I}_a$, ] (1.5,0);
\draw (0,-1.5) to [isource, l=$\underline{I}_b$, *-] (1.5,-1.5);
\draw (0,-3) to [isource, l=$\underline{I}_c$, ] (1.5,-3);
\draw (0,0) to [short] (0,-3);

\draw (1.5,0) to [R, l=$\underline{Z}_x$, -, european] (3.0,0);
\draw (1.5,-1.5) to [R, l=$\underline{Z}_x$, -, european] (3.0,-1.5);
\draw (1.5,-3) to [R, l=$\underline{Z}_x$, -, european] (3.0,-3);

\draw (3.0,0) to [short] (3.375,0);
\draw (3.0,-1.5) to [short] (3.375,-1.5);
\draw (3.0,-3) to [short] (3.375,-3);
\draw (3.375,0) to [short, *-] (3.75,0);
\draw (3.375,-1.5) to [short, *-] (3.75,-1.5);
\draw (3.375,-3) to [short, *-] (3.75,-3);

\draw (3.75,0) to [R, l=$\underline{Z}_v$, -, european] (5.25,0);
\draw (3.75,-1.5) to [R, l=$\underline{Z}_v$, -, european] (5.25,-1.5);
\draw (3.75,-3) to [R, l=$\underline{Z}_v$, -, european] (5.25,-3);

\draw (3.375,0.3) node[]{$\underline{V}_{pa}$};
\draw (3.375,-1.2) node[]{$\underline{V}_{pb}$};
\draw (3.375,-2.7) node[]{$\underline{V}_{pc}$};

\draw (5.25,0) to [short] (7.0,0);
\draw (5.25,-1.5) to [short] (6.3,-1.5);
\draw (5.25,-3) to [short] (7.0,-3);

\draw (7.0,0) to [short] (8,0);
\draw[dashed] (6.0,-1.5) to [short] (7.9,-1.5);
\draw (7.0,-3) to [short] (8,-3);

\draw (8.0,0) to [short] (9.25,0);
\draw (8.0,-1.5) to [short] (9.25,-1.5);
\draw (8.0,-3) to [short] (9.25,-3);

\draw[gray] (8.25,0) to [short, color=gray, *-] (8.25, -3.25);
\draw[gray] (8.75,-1.5) to [short, color=gray, *-] (8.75, -4.5);
\draw[gray] (9.25,-3) to [short, color=gray, *-] (9.25, -3.25);

\draw[gray] (8.25, -3.25) to [R, l_=$\underline{Z}_{ga}$, color=gray, european] (8.25, -4.75);
\draw[gray] (8.75, -4.5) to [R, l=$\underline{Z}_{gb}$, color=gray, european] (8.75, -6.0);
\draw[gray] (9.25, -3.25) to [R, l=$\underline{Z}_{gc}$, color=gray, european] (9.25, -4.75);

\draw[gray] (8.25, -4.75) -- (8.25, -6.05) node[ground]{};
\draw[gray] (8.75, -6) -- (8.75, -6.05) node[ground]{};
\draw[gray] (9.25, -4.75) -- (9.25, -6.05) node[ground]{};

\draw[gray] (5.75,0) to [R, l=$\underline{Z}_{ab}$, color=gray, european, *-*] (5.75,-1.5);
\draw[gray] (5.75,-1.5) to [R, l=$\underline{Z}_{bc}$, color=gray, european, *-*] (5.75,-3.0);
\draw[gray] (7.0,0) to [R, l=$\underline{Z}_{ac}$, color=gray, european, *-*] (7.0,-3.0);

\draw (9.25,0) to [short] (9.75, 0);
\draw (9.25,-1.5) to [short] (9.75, -1.5);
\draw (9.25,-3) to [short] (9.75, -3);

\draw (9.75,0) to [R, l=$\underline{Z}_{t}$, european] (11,0);
\draw (9.75,-1.5) to [R, l=$\underline{Z}_{t}$, european] (11,-1.5);
\draw (9.75,-3) to [R, l=$\underline{Z}_{t}$, european] (11,-3);

\draw (11,0) to [sV, l=$\underline{V}_{ta}$] (12.5,0);
\draw (11,-1.5) to [sV, l=$\underline{V}_{tb}$, -*] (12.5,-1.5);
\draw (11,-3) to [sV, l=$\underline{V}_{tc}$] (12.5,-3);
\draw (12.5,0) to [short] (12.5,-3);

\draw (8.25,0.3) node[]{$\underline{V}_{fa}$};
\draw (8.75,-1.2) node[]{$\underline{V}_{fb}$};
\draw (9.25,-2.7) node[]{$\underline{V}_{fc}$};

\draw (12.5, -1.5) to [short] (12.75, -1.5);
\draw (12.75, -1.5) -- (12.75, -3.5) node[ground]{};

% \draw (4,0) to [short] (6,0);
% \draw (4,-1.5) to [short] (6,-1.5);
% \draw (4,-3) to [short] (6,-3);
% \draw (0,0) to [short] (0,-3);
% % \draw (5,0) to [R, l=$\underline{Z}_f$, *-] (5,2);
% % \draw (5,2.05) -- (5,2) node[ground, rotate=180]{};
% \draw (5,0) to [short, *-*] (5,-1.5);
% \draw (5,-1.5) to [short, *-*] (5,-3);
% \draw (5,-3) -- (5,-3.25) node[ground]{};

% \draw (5.2,0.2) node[]{$\underline{U}_a$};
% \draw (5.2,-1.3) node[]{$\underline{U}_b$};
% \draw (5.2,-2.8) node[]{$\underline{U}_c$};

\end{circuitikz}
\caption{General scheme to analyze faults}
\label{fig:trif}
\end{figure}